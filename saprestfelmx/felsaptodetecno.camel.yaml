- rest:
    id: rest-68da
    path: /dev/fel/mx
    consumes: application/xml
    produces: application/xml
    get:
      - id: get-73ae
        path: /BuscarPdf40
        to: direct:BuscarPdf40
        consumes: application/xml
        produces: application/xml
      - id: get-0650
        path: /ComprobanteBuscar40
        to: direct:ComprobanteBuscar40
        consumes: application/xml
        produces: application/xml
    post:
      - id: post-87d6
        path: /ComprobanteGenerarSAT40
        to: direct:ComprobanteGenerarSAT40
        consumes: application/xml
        produces: application/xml
      - id: post-4fad
        path: /ComprobanteCancelar40
        to: direct:ComprobanteCancelar40
        consumes: application/xml
        produces: application/xml
- route:
    id: BuscarPdf40
    routeConfigurationId: rc-1396
    from:
      id: from-d8d8
      uri: direct
      parameters:
        name: BuscarPdf40
      steps:
        - setHeaders:
            id: setHeaders-3517
            description: Headers
            headers:
              - id: setHeader-0ba1
                name: licenciaValue
                expression:
                  xpath:
                    id: xpath-7795
                    expression: //Comprobante_BuscarPdf40/licencia/text()
              - id: setHeader-58b2
                name: facturaIdValue
                expression:
                  xpath:
                    id: xpath-f782
                    expression: //Comprobante_BuscarPdf40/facturaId/text()
        - setBody:
            id: setBody-541e
            description: SOAP
            expression:
              simple:
                id: simple-c494
                expression: "<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:tem=\"http://tempuri.org/\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\r\n\t<soap:Header>\r\n\t\t<a:Action soap:mustUnderstand=\"1\">http://tempuri.org/IDetecno/Comprobante_BuscarPdf40</a:Action>\r\n\t\t<a:To soap:mustUnderstand=\"1\">https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc</a:To>\r\n\t</soap:Header>\r\n\t<soap:Body>\r\n\t\t<tem:Comprobante_BuscarPdf40>\r\n\t\t\t<tem:licencia>${header.licenciaValue}</tem:licencia>\r\n\t\t\t<tem:facturaId>${header.facturaIdValue}</tem:facturaId>\r\n\t\t</tem:Comprobante_BuscarPdf40>\r\n\t</soap:Body>\r\n</soap:Envelope>"
        - removeHeaders:
            id: removeHeaders-e95b
            description: Headers
            pattern: CamelHttp*
        - setHeader:
            id: setHeader-4887
            description: XML
            name: Content-Type
            expression:
              simple:
                id: simple-4937
                expression: application/soap+xml
        - to:
            id: to-0085
            uri: http
            parameters:
              disableStreamCache: true
              bridgeEndpoint: true
              httpMethod: POST
              httpUri: >-
                https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc
              throwExceptionOnFailure: true
        - to:
            id: to-cc9b
            description: XML
            uri: xslt
            parameters:
              resourceUri: classpath:00_Xml_Response.xsl
        - log:
            id: log-072e
            message: ${body}
            loggingLevel: INFO
- route:
    id: ComprobanteBuscar40
    routeConfigurationId: rc-1396
    from:
      id: from-c914
      uri: direct
      parameters:
        name: ComprobanteBuscar40
      steps:
        - setHeaders:
            id: setHeaders-06dc
            description: Headers
            headers:
              - id: setHeader-caa6
                name: licenciaValue
                expression:
                  xpath:
                    id: xpath-1fb9
                    expression: //ComprobanteBuscar40/licencia/text()
              - id: setHeader-06ab
                name: facturaIdValue
                expression:
                  xpath:
                    id: xpath-653c
                    expression: //ComprobanteBuscar40/facturaId/text()
        - setBody:
            id: setBody-5411
            description: SOAP
            expression:
              simple:
                id: simple-c494
                expression: "<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:tem=\"http://tempuri.org/\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\r\n\t<soap:Header>\r\n\t\t<a:Action soap:mustUnderstand=\"1\">http://tempuri.org/IDetecno/ComprobanteBuscar40</a:Action>\r\n\t\t<a:To soap:mustUnderstand=\"1\">https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc</a:To>\r\n\t</soap:Header>\r\n   <soap:Body>\r\n      <tem:ComprobanteBuscar40>\r\n         <!--Optional:-->\r\n         <tem:licencia>${header.licenciaValue}</tem:licencia>\r\n         <!--Optional:-->\r\n         <tem:facturaId>${header.facturaIdValue}</tem:facturaId>\r\n      </tem:ComprobanteBuscar40>\r\n   </soap:Body>\r\n</soap:Envelope>"
        - removeHeaders:
            id: removeHeaders-e951
            description: Headers
            pattern: CamelHttp*
        - setHeader:
            id: setHeader-4881
            description: XML
            name: Content-Type
            expression:
              simple:
                id: simple-4937
                expression: application/soap+xml
        - to:
            id: to-00851
            uri: http
            parameters:
              disableStreamCache: true
              bridgeEndpoint: true
              httpMethod: POST
              httpUri: >-
                https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc
              throwExceptionOnFailure: true
        - to:
            id: to-cc9b1
            description: XML
            uri: xslt
            parameters:
              resourceUri: classpath:00_Xml_Response.xsl
        - log:
            id: log-3cff
            message: ${body}
            loggingLevel: INFO
- route:
    id: ComprobanteCancelar40
    routeConfigurationId: rc-1396
    from:
      id: from-d1c6
      uri: direct
      parameters:
        name: ComprobanteCancelar40
      steps:
        - setHeaders:
            id: setHeaders-6418
            description: Headers
            headers:
              - id: setHeader-386c
                name: licenciaValue
                expression:
                  xpath:
                    id: xpath-a28c
                    expression: //ComprobanteCancelar40/licencia/text()
              - id: setHeader-23e8
                name: facturaIdValue
                expression:
                  xpath:
                    id: xpath-eedd
                    expression: //ComprobanteCancelar40/facturaId/text()
              - id: setHeader-695e
                name: MotivoCancelacionValue
                expression:
                  xpath:
                    id: xpath-9ce5
                    expression: //ComprobanteCancelar40/MotivoCancelacion/text()
              - id: setHeader-ffd8
                name: FolioSustitucionValue
                expression:
                  xpath:
                    id: xpath-29bf
                    expression: //ComprobanteCancelar40/FolioSustitucion/text()
        - setBody:
            id: setBody-54112
            description: SOAP
            expression:
              simple:
                id: simple-c494
                expression: "<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" xmlns:tem=\"http://tempuri.org/\" xmlns:a=\"http://www.w3.org/2005/08/addressing\">\r\n\t<soap:Header>\r\n\t\t<a:Action soap:mustUnderstand=\"1\">http://tempuri.org/IDetecno/ComprobanteCancelar40</a:Action>\r\n\t\t<a:To soap:mustUnderstand=\"1\">https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc</a:To>\r\n\t</soap:Header>\r\n   <soap:Body>\r\n      <tem:ComprobanteCancelar40>\r\n         <!--Optional:-->\r\n         <tem:licencia>${header.licenciaValue}</tem:licencia>\r\n         <!--Optional:-->\r\n         <tem:facturaId>${header.facturaIdValue}</tem:facturaId>\r\n         <!--Optional:-->\r\n         <tem:MotivoCancelacion>${header.MotivoCancelacionValue}</tem:MotivoCancelacion>\r\n         <!--Optional:-->\r\n         <tem:FolioSustitucion>${header.FolioSustitucionValue}</tem:FolioSustitucion>\r\n      </tem:ComprobanteCancelar40>\r\n   </soap:Body>\r\n</soap:Envelope>"
        - removeHeaders:
            id: removeHeaders-e9512
            description: Headers
            pattern: CamelHttp*
        - setHeader:
            id: setHeader-48812
            description: XML
            name: Content-Type
            expression:
              simple:
                id: simple-4937
                expression: application/soap+xml
        - to:
            id: to-008512
            uri: http
            parameters:
              disableStreamCache: true
              bridgeEndpoint: true
              httpMethod: POST
              httpUri: >-
                https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc
              throwExceptionOnFailure: true
        - to:
            id: to-cc9b12
            description: XML
            uri: xslt
            parameters:
              resourceUri: classpath:00_Xml_Response.xsl
        - log:
            id: log-fc96
            message: ${body}
            loggingLevel: INFO
- route:
    id: ComprobanteGenerarSAT40
    routeConfigurationId: rc-1396
    from:
      id: from-9607
      uri: direct
      parameters:
        name: ComprobanteGenerarSAT40
      steps:
        - setHeaders:
            id: setHeaders-cc7e
            description: Headers
            headers:
              - id: setHeader-ffa8
                name: licenciaValue
                expression:
                  xpath:
                    id: xpath-6bd3
                    expression: //ComprobanteGenerarSAT40/licencia/text()
              - id: setHeader-cb32
                name: cerBytesValue
                expression:
                  xpath:
                    id: xpath-0640
                    expression: //ComprobanteGenerarSAT40/cerBytes/text()
              - id: setHeader-b536
                name: keyBytesValue
                expression:
                  xpath:
                    id: xpath-65b9
                    expression: //ComprobanteGenerarSAT40/keyBytes/text()
              - id: setHeader-3dea
                name: passBytesValue
                expression:
                  xpath:
                    id: xpath-5e0a
                    expression: //ComprobanteGenerarSAT40/passBytes/text()
        - setBody:
            id: setBody-6276
            expression:
              xpath:
                id: xpath-0ac9
                expression: //ComprobanteGenerarSAT40/xml/*[1]
        - marshal:
            id: marshal-9eb6
            base64:
              id: base64-5738
        - setBody:
            id: setBody-7686
            description: SOAP
            expression:
              simple:
                id: simple-9763
                expression: "<soap:Envelope xmlns:soap=\"http://www.w3.org/2003/05/soap-envelope\" \r\n               xmlns:tem=\"http://tempuri.org/\"\r\n               xmlns:a=\"http://www.w3.org/2005/08/addressing\">\r\n   <soap:Header>\r\n      <a:Action soap:mustUnderstand=\"1\">http://tempuri.org/IDetecno/ComprobanteGenerarSAT40</a:Action>\r\n      <a:To soap:mustUnderstand=\"1\">https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc</a:To>\r\n     \r\n   </soap:Header>\r\n   \r\n   <soap:Body>\r\n      <tem:ComprobanteGenerarSAT40>\r\n         <!--Optional:-->\r\n         <tem:licencia>${header.licenciaValue}</tem:licencia>\r\n         <!--Optional:-->\r\n         <tem:cerBytes>${header.cerBytesValue}</tem:cerBytes>\r\n         <!--Optional:-->\r\n         <tem:keyBytes>${header.keyBytesValue}</tem:keyBytes>\r\n         <!--Optional:-->\r\n         <tem:passBytes>${header.passBytesValue}</tem:passBytes>\r\n         <!--Optional:-->\r\n         <tem:xml>${body}</tem:xml>\r\n      </tem:ComprobanteGenerarSAT40>\r\n   </soap:Body>\r\n</soap:Envelope>\r\n"
        - removeHeaders:
            id: removeHeaders-641e
            description: Headers
            pattern: CamelHttp*
        - setHeader:
            id: setHeader-ad0b
            description: XML
            name: Content-Type
            expression:
              simple:
                id: simple-cf8d
                expression: application/soap+xml
        - to:
            id: to-ff17
            uri: http
            parameters:
              disableStreamCache: true
              bridgeEndpoint: true
              httpMethod: POST
              httpUri: >-
                https://detecno-factura-electronica.com/Emision/cfdiWcfEmisionServicio40_Demo/Detecno.svc
              throwExceptionOnFailure: true
        - to:
            id: to-ff4e
            description: XML
            uri: xslt
            parameters:
              resourceUri: classpath:00_Xml_Response.xsl
        - log:
            id: log-aa24
            description: LOG
            message: ${body}
            loggingLevel: INFO
- routeConfiguration:
    id: rc-1396
    errorHandler:
      id: errorHandler-5e50
      deadLetterChannel:
        id: deadLetterChannel-aed6
        deadLetterUri: log:deadLetterLog?level=ERROR
        redeliveryPolicy:
          id: redeliveryPolicy-b091
          maximumRedeliveries: 3
          redeliveryDelay: "5000"
          backOffMultiplier: 2
